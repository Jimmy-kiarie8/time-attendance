import{_ as X}from"./FormComponent-BXJpgamY.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as s,D as F,i as l,o as d,c as p,w as o,b as a,f as u,d as N,g as j,t as U,F as $,e as A,a as k}from"./app-C40yS1Zs.js";const Z={__name:"documents",props:{},setup(h,{expose:B}){B({show:q});const c=s(null),v=s(!1),_=s(!1),y=s([]),f=s([]),b=f.value.reduce((t,e)=>(e.type==="file"?t[e.model]=e.multiple?[]:null:t[e.model]=e.value||"",t),{}),r=F({...b});s(null);const O=F({}),g=s(!1),w=s("Updated"),x=s("black"),J=async()=>{try{const t=await axios.get("/json-data?file=documents.json");f.value=t.data,f.value.forEach(e=>{e.type==="file"?(r[e.model]=e.multiple?[]:null,O[e.model]=s(null)):r[e.model]=e.value})}catch(t){console.error("Error loading JSON data:",t),showSnackbar("Failed to load menu data","error")}};function R(){Object.keys(b).forEach(t=>{r[t]=Array.isArray(b[t])?[]:b[t]})}const T=async()=>{try{const t=await axios.get(`/client-documents/${c.value.client_id}`);y.value=t.data}catch(t){console.error("Error loading JSON data:",t),showSnackbar("Failed to load menu data","error")}};function q(t){console.log(t),v.value=!0,c.value=t,J(),T()}function I(){_.value=!0;const t=new FormData;Object.keys(r).forEach(e=>{const m=f.value.find(i=>i.model===e);m&&m.type==="file"?m.multiple&&Array.isArray(r[e])?r[e].forEach(i=>{t.append(`${e}[]`,i)}):r[e]&&t.append(e,r[e]):t.append(e,r[e])}),axios.post(`/loan-docs/${c.value.id}`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{g.value=!0,x.value="success",w.value=e.data.message||"Updated",_.value=!1,R(),v.value=!1}).catch(e=>{console.error(e),g.value=!0,x.value="error",w.value="Something went wrong!",_.value=!1})}return(t,e)=>{const m=l("v-card-title"),i=l("v-list-subheader"),L=l("v-list-item-title"),C=l("v-list-item"),E=l("v-list"),D=l("v-card"),z=l("v-icon"),G=l("v-avatar"),V=l("v-btn"),H=l("v-card-text"),K=l("v-spacer"),M=l("v-card-actions"),P=l("v-snackbar"),Q=l("v-dialog"),W=l("v-row");return d(),p(W,{justify:"center"},{default:o(()=>[a(Q,{persistent:"",modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=n=>v.value=n),width:"1000"},{default:o(()=>[a(D,null,{default:o(()=>[a(m,{"primary-title":""},{default:o(()=>e[4]||(e[4]=[u(" Documents ")])),_:1}),a(H,null,{default:o(()=>[c.value?(d(),p(D,{key:0,variant:"tonal",color:"error"},{default:o(()=>[a(E,{density:"compact"},{default:o(()=>[a(i,null,{default:o(()=>e[5]||(e[5]=[u("Required")])),_:1}),(d(!0),N($,null,j(c.value.loantype.documents,(n,S)=>(d(),p(C,{key:S,value:S,color:"error"},{default:o(()=>[a(L,null,{default:o(()=>[u(U(n),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})):A("",!0),e[8]||(e[8]=k("br",null,null,-1)),y.value.length>0?(d(),p(D,{key:1,variant:"tonal",color:"info"},{default:o(()=>[a(E,{lines:"two",density:"compact",rounded:""},{default:o(()=>[a(i,{inset:""},{default:o(()=>e[6]||(e[6]=[u("Existing Documents")])),_:1}),(d(!0),N($,null,j(y.value,n=>(d(),p(C,{key:n.id,subtitle:n.created_at,title:n.fileValue,value:n.id},{prepend:o(()=>[a(G,null,{default:o(()=>[a(z,{color:"white"},{default:o(()=>e[7]||(e[7]=[u("mdi-file-pdf-box")])),_:1})]),_:1})]),append:o(()=>[a(V,{icon:"mdi-eye",variant:"text",href:n.path,target:"_blank"},null,8,["href"])]),_:2},1032,["subtitle","title","value"]))),128))]),_:1})]),_:1})):A("",!0),e[9]||(e[9]=k("br",null,null,-1)),e[10]||(e[10]=k("br",null,null,-1)),a(X,{formData:f.value,form:r,"onUpdate:form":e[0]||(e[0]=n=>r=n)},null,8,["formData","form"])]),_:1}),a(M,null,{default:o(()=>[a(V,{color:"error",variant:"outlined",onClick:e[1]||(e[1]=n=>v.value=!1)},{default:o(()=>e[11]||(e[11]=[u("Close")])),_:1}),a(K),a(V,{color:"info",variant:"outlined",onClick:I,loading:_.value},{default:o(()=>e[12]||(e[12]=[u("Submit")])),_:1},8,["loading"])]),_:1})]),_:1}),a(P,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=n=>g.value=n),color:x.value},{default:o(()=>[u(U(w.value),1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])]),_:1})}}},ae=Y(Z,[["__scopeId","data-v-318ff84f"]]);export{ae as default};
