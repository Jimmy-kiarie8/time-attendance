import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{i as n,o as r,c as d,w as i,b as u,d as x,g as R,e as p,F as C}from"./app-DTApRKiJ.js";const V={props:{filterRoute:String,modelRoute:String,filterData:Object},data(){return{report_data:[],headers:[],search:"",page:1,loading:!1,itemsPerPage:5,statuses:["Scheduled","Cancelled","Delivered","Returned","Dispatched"]}},methods:{filter(){this.loading=!0;let a={};this.filterData.forEach(e=>{a[e.model]=e.value}),this.$emit("load",!0),axios.post(`/${this.filterRoute}`,a).then(e=>{console.log(e),this.loading=!1,this.data=e.data,this.$emit("filter",e.data),this.$emit("load",!1)}).catch(e=>{this.loading=!1,this.$emit("load",!1)})},refresh(){this.$emit("refresh")},async downloadReport(a){this.loading=!0;try{const e=this.filterData.reduce((t,l)=>(Array.isArray(l.value)?t[l.model]=l.value.map(m=>m.value):l.value&&typeof l.value=="object"?t[l.model]=l.value.value:t[l.model]=l.value,t),{});e.filetype=a;const s=await axios.post("/download-export",e,{responseType:"blob"}),_=new Blob([s.data],{type:a==="pdf"?"application/pdf":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),c=window.URL.createObjectURL(_);if(a==="pdf")window.open(c,"_blank");else{const t=document.createElement("a");t.href=c,t.setAttribute("download",`Report_${new Date().toISOString()}.xlsx`),document.body.appendChild(t),t.click(),document.body.removeChild(t)}window.URL.revokeObjectURL(c),this.loading=!1}catch(e){this.loading=!1,console.error("Error downloading report:",e)}}}};function D(a,e,s,_,c,t){const l=n("v-autocomplete"),m=n("v-text-field"),h=n("v-col"),f=n("v-btn"),b=n("v-btn-group"),y=n("v-row"),g=n("v-card");return r(),d(g,{class:"mx-auto",variant:"flat"},{default:i(()=>[u(y,null,{default:i(()=>[(r(!0),x(C,null,R(s.filterData,(o,w)=>(r(),d(h,{key:w,cols:"12",sm:"2"},{default:i(()=>[o.type=="select"?(r(),d(l,{key:0,clearable:"",chips:"",label:o.label,items:o.items,variant:"outlined","item-title":"label","item-value":"value",modelValue:o.value,"onUpdate:modelValue":v=>o.value=v,multiple:o.multiple,"return-object":"",density:"compact"},null,8,["label","items","modelValue","onUpdate:modelValue","multiple"])):p("",!0),o.type=="date"?(r(),d(m,{key:1,clearable:"",label:o.label,variant:"outlined",modelValue:o.value,"onUpdate:modelValue":v=>o.value=v,type:"date",density:"compact"},null,8,["label","modelValue","onUpdate:modelValue"])):p("",!0)]),_:2},1024))),128)),u(h,null,{default:i(()=>[u(b,{divided:""},{default:i(()=>[u(f,{color:"primary",icon:"mdi-magnify",onClick:t.filter},null,8,["onClick"]),s.modelRoute==="loans"?(r(),d(f,{key:0,color:"primary",icon:"mdi-file-excel-outline",onClick:e[0]||(e[0]=o=>t.downloadReport("excle"))})):p("",!0),s.modelRoute==="loans"?(r(),d(f,{key:1,color:"primary",icon:"mdi-file-pdf-box",onClick:e[1]||(e[1]=o=>t.downloadReport("pdf"))})):p("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}const j=k(V,[["render",D],["__scopeId","data-v-a7ef85e1"]]);export{j as default};
