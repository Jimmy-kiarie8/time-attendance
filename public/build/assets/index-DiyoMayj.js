import{_ as z}from"./MainLayout-DMJJ9kEn.js";import{R as k,V as h,i as a,o as d,c as r,w as t,a as v,b as l,f as n,t as g,y as b,e as F,d as N,g as S,F as T}from"./app-DCy3SzMC.js";import U from"./create-Dnmc6pWz.js";import K from"./edit-DCZpjamc.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FormComponent-Club6oMY.js";const q={props:{data:Object,permissions:Object,company:Object,headers:Object,actions:Object,modelRoute:String,title:String,upload:Boolean},components:{MainLayout:z,myCreate:U,myEdit:K},data(){return{search:"",page:1,itemsPerPage:5,table_data:{},loading:!1,dialogDelete:!1}},methods:{goTo(o){k.visit(o)},refresh(){this.loading=!0,h.get(`${this.modelRoute}?axios=true`).then(o=>{this.loading=!1,this.table_data=o.data,console.log("ðŸš€ ~ axios.get ~ res:",o)}).catch(o=>{this.loading=!1,console.log("ðŸš€ ~ axios.get ~ error:",o)})},runAction(o,e){console.log("ðŸš€ ~ runAction ~ action:",e.action_name),e.action_name=="Edit"?this.openEdit(o):e.action_name=="Delete"?this.deleteItem(o):e.action_name=="Logo"?this.uploadImage(o):this.action_run(o,e.route)},async action_run(o,e){this.loading=!0;try{const i=await h.post(`/${e}`,o);console.log("ðŸš€ ~ dispatch ~ response:",i)}catch(i){console.log("ðŸš€ ~ axios.get ~ error:",i)}finally{this.loading=!1}},uploadImage(o){this.$refs.imageModal.show(o)},openEdit(o){console.log("ðŸš€ ~ openEdit ~ data:",o),this.$refs.editModal.show(o.id)},openCreate(){this.$refs.createModal.show()},geoFence(o){k.visit(`/geofences/${o}`)},uploadItem(){this.$refs.uploadModal.show()},close(){this.dialogDelete=!1},deleteItem(o){console.log("ðŸš€ ~ deleteItem ~ item:",o),this.editedIndex=this.data.data.indexOf(o),this.deleteId=o.id,this.dialogDelete=!0},deleteItemConfirm(){h.delete(`${this.modelRoute}/${this.deleteId}`).then(o=>{console.log("ðŸš€ ~ axios.delete ~ res:",o),this.dialogDelete=!0,this.data.data.splice(this.editedIndex,1),this.close()}).catch(o=>{console.log("ðŸš€ ~ axios.delete ~ error:",o)})}},computed:{pageCount(){return Math.ceil(this.data.data.length/this.itemsPerPage)}},mounted(){this.table_data=this.data}},G={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},H={class:"actions"};function J(o,e,i,Q,m,u){const C=a("v-toolbar-title"),p=a("v-divider"),x=a("v-spacer"),c=a("v-icon"),f=a("v-btn"),y=a("v-tooltip"),R=a("v-toolbar"),w=a("v-text-field"),I=a("v-data-table"),M=a("myEdit"),V=a("myCreate"),D=a("v-card-title"),E=a("v-card-text"),O=a("v-card-actions"),A=a("v-card"),B=a("v-dialog"),j=a("MainLayout");return d(),r(j,{title:i.title,modelRoute:i.modelRoute,company:i.company,rail:!1,ref:"snackBarModal"},{default:t(()=>[v("div",G,[l(I,{headers:i.headers,items:m.table_data.data,"sort-by":[{key:"name",order:"asc"}],class:"elevation-2",search:m.search,loading:m.loading},{top:t(()=>[l(R,{flat:""},{default:t(()=>[l(C,null,{default:t(()=>[n(g(i.title)+" Management",1)]),_:1}),l(p,{class:"mx-4",inset:"",vertical:""}),l(x),l(y,{location:"bottom"},{activator:t(({props:s})=>[l(f,b({icon:""},s,{onClick:e[0]||(e[0]=_=>u.refresh())}),{default:t(()=>[l(c,{color:"info"},{default:t(()=>e[5]||(e[5]=[n(" mdi-refresh ")])),_:1})]),_:2},1040)]),default:t(()=>[e[6]||(e[6]=v("span",null,"View geofences",-1))]),_:1}),i.modelRoute!=="geofences"?(d(),r(f,{key:0,"prepend-icon":"mdi-plus-circle",variant:"outlined",onClick:e[1]||(e[1]=s=>u.openCreate("geocoder")),color:"info"},{default:t(()=>[n(" Add "+g(i.title),1)]),_:1})):(d(),r(f,{key:1,"prepend-icon":"mdi-plus-circle",variant:"tonal",onClick:e[2]||(e[2]=s=>u.goTo("geocoder")),color:"info",rounded:""},{default:t(()=>[n(" Add "+g(i.title),1)]),_:1})),i.upload?(d(),r(f,{key:2,"prepend-icon":"mdi-upload",variant:"outlined",onClick:u.uploadItem,color:"info"},{default:t(()=>e[7]||(e[7]=[n(" Upload ")])),_:1},8,["onClick"])):F("",!0)]),_:1}),l(w,{modelValue:m.search,"onUpdate:modelValue":e[3]||(e[3]=s=>m.search=s),"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},null,8,["modelValue"])]),"item.actions":t(({item:s})=>[v("div",H,[(d(!0),N(T,null,S(i.actions,(_,L)=>(d(),r(y,{location:"bottom",key:L},{activator:t(({props:P})=>[l(f,b({icon:"",ref_for:!0},P,{onClick:X=>u.runAction(s,_),variant:"text",color:_.color}),{default:t(()=>[l(c,null,{default:t(()=>[n(g(_.icon),1)]),_:2},1024)]),_:2},1040,["onClick","color"])]),default:t(()=>[v("span",null,g(_.action_name),1)]),_:2},1024))),128))])]),"item.availability_status":t(({value:s})=>[s?(d(),r(c,{key:0,color:"success",size:"x-small"},{default:t(()=>e[8]||(e[8]=[n("mdi-circle")])),_:1})):(d(),r(c,{key:1,color:"red",size:"x-small"},{default:t(()=>e[9]||(e[9]=[n("mdi-circle")])),_:1}))]),"item.active":t(({value:s})=>[s?(d(),r(c,{key:0,color:"success",size:"x-small"},{default:t(()=>e[10]||(e[10]=[n("mdi-circle")])),_:1})):(d(),r(c,{key:1,color:"red",size:"x-small"},{default:t(()=>e[11]||(e[11]=[n("mdi-circle")])),_:1}))]),_:1},8,["headers","items","search","loading"])]),l(M,{ref:"editModal",modelRoute:i.modelRoute,title:i.title},null,8,["modelRoute","title"]),l(V,{ref:"createModal",title:i.title,modelRoute:i.modelRoute,permissions:i.permissions},null,8,["title","modelRoute","permissions"]),l(B,{modelValue:m.dialogDelete,"onUpdate:modelValue":e[4]||(e[4]=s=>m.dialogDelete=s),"max-width":"400px"},{default:t(()=>[l(A,null,{default:t(()=>[l(D,{class:"text-h5"},{default:t(()=>e[12]||(e[12]=[n("Warning!")])),_:1}),l(p),l(E,null,{default:t(()=>e[13]||(e[13]=[n(" Are you sure you want to delete this item? ")])),_:1}),l(p),l(O,null,{default:t(()=>[l(f,{color:"red-darken-1",variant:"tonal",onClick:u.close},{default:t(()=>[l(c,null,{default:t(()=>e[14]||(e[14]=[n("mdi-close-box")])),_:1}),e[15]||(e[15]=n("Cancel "))]),_:1},8,["onClick"]),l(x),l(f,{color:"info",variant:"tonal",onClick:u.deleteItemConfirm},{default:t(()=>[l(c,null,{default:t(()=>e[16]||(e[16]=[n("mdi-checkbox-marked")])),_:1}),e[17]||(e[17]=n("OK "))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title","modelRoute","company"])}const le=W(q,[["render",J]]);export{le as default};
