import{_ as j}from"./MainLayout-BgYJj6nL.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{i,o as p,c as m,w as a,b as c,d as k,g as A,e as w,F as B,a as f,f as r,t as u}from"./app-CgSA-0rK.js";const E={props:{reports:Object,locations:Object,form_data:Object},components:{MainLayout:j},data(){return{report_data:[],headers:[],search:"",page:1,loading:!1,itemsPerPage:5,statuses:["Scheduled","Cancelled","Delivered","Returned","Dispatched"]}},methods:{statusUpdate(l){this.$refs.statusModal.show(l)},updateLocation(l){this.$refs.locationModal.show(l)},getIcon(l){switch(l){case"delivered":return"mdi-check-circle";case"cancelled":return"mdi-cancel";case"returned":return"mdi-undo";case"Scheduled":return"mdi-clock";case"Dispatched":return"mdi-send";default:return"mdi-information"}},getColor(l){switch(l){case"delivered":return"success";case"cancelled":return"error";case"returned":return"error";case"Scheduled":return"primary";case"Dispatched":return"warning";default:return""}},async downloadReport1(l){this.loading=!0;try{const e=this.form_data.reduce((d,_)=>(d[_.model]={label:_.label,value:_.value},d),{}),n=await axios.post(`/admin/reports/download?filetype=${l}`,e,{responseType:"blob"}),v=new Blob([n.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(v),o=document.createElement("a");o.href=s,l==="pdf"?o.setAttribute("download",`Report_${new Date().toISOString()}.pdf`):o.setAttribute("download",`Report_${new Date().toISOString()}.xlsx`),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(s),this.loading=!1}catch(e){this.loading=!1,console.error("Error downloading report:",e)}},async downloadReport(l){this.loading=!0;try{const e=this.form_data.reduce((o,d)=>(Array.isArray(d.value)?o[d.model]=d.value.map(_=>_.value):d.value&&typeof d.value=="object"?o[d.model]=d.value.value:o[d.model]=d.value,o),{}),n=await axios.post(`/report-download?filetype=${l}`,e,{responseType:"blob"}),v=new Blob([n.data],{type:l==="pdf"?"application/pdf":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(v);if(l==="pdf")window.open(s,"_blank");else{const o=document.createElement("a");o.href=s,o.setAttribute("download",`Report_${new Date().toISOString()}.xlsx`),document.body.appendChild(o),o.click(),document.body.removeChild(o)}window.URL.revokeObjectURL(s),this.loading=!1}catch(e){this.loading=!1,console.error("Error downloading report:",e)}},generate(){this.loading=!0;const l=this.form_data.reduce((e,n)=>(Array.isArray(n.value)?e[n.model]=n.value.map(v=>v.value):n.value&&typeof n.value=="object"?e[n.model]=n.value.value:e[n.model]=n.value,e),{});console.log(l),axios.post("/report",l).then(e=>{this.loading=!1,this.headers=e.data.headers,this.report_data=e.data}).catch(e=>{this.loading=!1})}},computed:{pageCount(){return Math.ceil(this.reports.data.length/this.itemsPerPage)}}},M={style:{"text-align":"center"}},P={key:0,class:"overflow-hidden shadow-xl sm:rounded-lg"},$={id:"tooltip"},I={id:"tooltip"},N={id:"tooltip"},T={id:"tooltip"},z={id:"tooltip"};function F(l,e,n,v,s,o){const d=i("v-autocomplete"),_=i("v-text-field"),g=i("v-col"),R=i("v-row"),b=i("v-btn"),C=i("v-card-text"),L=i("v-card"),U=i("v-skeleton-loader"),h=i("v-tooltip"),x=i("v-icon"),V=i("v-data-table"),D=i("MainLayout");return p(),m(D,{title:"Reports"},{default:a(()=>[c(L,{class:"mx-auto",loading:s.loading},{default:a(()=>[c(C,null,{default:a(()=>[c(R,null,{default:a(()=>[(p(!0),k(B,null,A(n.form_data,(t,S)=>(p(),m(g,{key:S,cols:"12",sm:"4"},{default:a(()=>[t.type=="select"?(p(),m(d,{key:0,clearable:"",chips:"",label:t.label,items:t.items,variant:"outlined","item-title":"label","item-value":"value",modelValue:t.value,"onUpdate:modelValue":y=>t.value=y,multiple:t.multiple,"return-object":"",density:"compact"},null,8,["label","items","modelValue","onUpdate:modelValue","multiple"])):w("",!0),t.type=="date"?(p(),m(_,{key:1,clearable:"",label:t.label,variant:"outlined",modelValue:t.value,"onUpdate:modelValue":y=>t.value=y,density:"compact",type:"date"},null,8,["label","modelValue","onUpdate:modelValue"])):w("",!0)]),_:2},1024))),128)),c(g)]),_:1}),f("div",M,[c(b,{"prepend-icon":"mdi-magnify",variant:"tonal",onClick:e[0]||(e[0]=t=>o.generate())},{default:a(()=>e[3]||(e[3]=[r(" Search ")])),_:1}),c(b,{"prepend-icon":"mdi-file-excel",variant:"tonal",onClick:e[1]||(e[1]=t=>o.downloadReport("excel")),style:{"margin-left":"6px"}},{default:a(()=>e[4]||(e[4]=[r(" Excel ")])),_:1}),c(b,{"prepend-icon":"mdi-file-pdf-box",variant:"tonal",onClick:e[2]||(e[2]=t=>o.downloadReport("pdf")),style:{"margin-left":"6px"}},{default:a(()=>e[5]||(e[5]=[r(" Pdf ")])),_:1})])]),_:1})]),_:1},8,["loading"]),e[8]||(e[8]=f("br",null,null,-1)),s.report_data?(p(),k("div",P,[s.loading?(p(),m(U,{key:0,type:"table"})):(p(),m(V,{key:1,headers:s.headers,items:s.report_data.data,"sort-by":[{key:"product_name",order:"asc"}],class:"elevation-2",search:s.search},{"item.description":a(({value:t})=>[f("p",$,[r(u(t)+" ",1),c(h,{activator:"parent",location:"top"},{default:a(()=>[r(u(t),1)]),_:2},1024)])]),"item.short_description":a(({value:t})=>[f("p",I,[r(u(t)+" ",1),c(h,{activator:"parent",location:"top"},{default:a(()=>[r(u(t),1)]),_:2},1024)])]),"item.paid":a(({value:t})=>[t?(p(),m(x,{key:0,color:"success",size:"x-small"},{default:a(()=>e[6]||(e[6]=[r("mdi-circle")])),_:1})):(p(),m(x,{key:1,color:"red",size:"x-small"},{default:a(()=>e[7]||(e[7]=[r("mdi-circle")])),_:1}))]),"item.notes":a(({value:t})=>[f("p",N,[r(u(t)+" ",1),c(h,{activator:"parent",location:"top"},{default:a(()=>[r(u(t),1)]),_:2},1024)])]),"item.customer_notes":a(({value:t})=>[f("p",T,[r(u(t)+" ",1),c(h,{activator:"parent",location:"top"},{default:a(()=>[r(u(t),1)]),_:2},1024)])]),"item.client_address":a(({value:t})=>[f("p",z,[r(u(t)+" ",1),c(h,{activator:"parent",location:"top"},{default:a(()=>[r(u(t),1)]),_:2},1024)])]),_:1},8,["headers","items","search"]))])):w("",!0)]),_:1})}const J=O(E,[["render",F]]);export{J as default};
