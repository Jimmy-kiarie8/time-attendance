import U from"./edit-DSr8XIZY.js";import{V as g,i as r,o as d,d as v,c as m,w as n,b as l,y as b,f as a,a as y,e as C,F as N,g as W,t as u}from"./app-DTApRKiJ.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FormComponent-T6cX9zNy.js";const T={components:{componentEdit:U},props:{tableData:Object,formData:Object,headers:Object,modelRoute:String,title:String,loading:Boolean,upload:Boolean,canCreate:Boolean,actions:Object,modalWidth:Number},data(){return{search:"",page:1,sortBy:[{key:"reference",order:"desc"}],dialogDelete:!1,selected:[],itemsPerPage:5,editedIndex:-1,editedItem:{},dialogConfirm:!1,snackbar:!1,text:"Updated",color:"black",current_data:null,current_route:null,warning_text:"Are you sure you want to delete this item"}},methods:{reverse(t){this.dialogConfirm=!0,this.current_data=t,this.current_route=`reverse/${t.id}`,this.warning_text="Are you sure you want to reverse",action_run(t,route)},shouldShowButton(t,e){return e.show?Array.isArray(e.show.value)?e.show.value.includes(t[e.show.label]):e.show.value===t[e.show.label]:!0},getIcon(t){switch(t){case"On time":return"mdi-check-circle";case"Late":case"Early":return"mdi-cancel";default:return"mdi-information"}},getColor(t){switch(t){case"Late":case"Early":return"red";case"On time":return"success";case"In":return"Info";case"Out":return"secondary";default:return""}},valueInArray(t,e){e.some(function(s){return console.log(t,s),console.log(s===t),s===t})},async refresh(){this.$emit("refresh",!1)},runAction(t,e){e.action_name=="Edit"?this.openEdit(t):e.action_name=="Delete"?this.deleteItem(t):e.action_name=="View Loan"?this.openShow(t):e.action_name=="Documents"?this.upenDocument(t):e.action_name=="Logo"?this.uploadImage(t):e.action_name=="Password"?this.passwordReset(t,e.route):e.action_name=="Repay Loan"?this.openPayment(t,e.route):e.action_name=="Reschedule"?this.rescheduleLoan(t,e.route):e.action_name=="View Loan"?this.openLoan(t,e.route):e.action_name=="Approve"||e.action_name=="Reject"||e.action_name=="Disburse"?(this.dialogConfirm=!0,this.current_data=t,this.current_route=e.route,this.warning_text=`Are you sure you want to ${e.action_name}`):e.action_name=="Open File"?window.open(t.path,"_blank"):this.action_run(t,e.route)},async action_run(t,e){this.$props.loading=!0,this.dialogConfirm=!1;try{const s=await g.post(`/${e}`,t);console.log("ðŸš€ ~ dispatch ~ response:",s),this.refresh(),this.snackbar=!0,this.color="success",this.text=s.data.message??"Updated"}catch(s){console.log("ðŸš€ ~ axios.get ~ error:",s),this.snackbar=!0,this.color="error",this.text="Something went wrong!"}finally{this.$props.loading=!1}},goTo(t){router.visit(t)},openEdit(t){this.$refs.editModal.show(t)},openShow(t){this.$refs.showModal.show(t)},upenDocument(t){this.$refs.documentModal.show(t)},openPayment(t,e){this.$refs.paymentModal.show(t,e)},openLoan(t,e){this.$refs.showModal.show(t,e)},rescheduleLoan(t,e){this.$refs.rescheduleModal.show(t,e)},deleteItem(t){this.editedIndex=this.data.data.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){g.delete(`${this.modelRoute}/${this.editedItem.id}`).then(t=>{console.log("ðŸš€ ~ axios.delete ~ res:",t),this.dialogDelete=!0,this.data.data.splice(this.editedIndex,1),this.close()}).catch(t=>{console.log("ðŸš€ ~ axios.delete ~ error:",t)})},actionConfirm(t,e){this.action_run(t,e)},close(){this.dialogDelete=!1},uploadItem(){this.$refs.uploadModal.show()},editLoan(t,e){this.$refs.editLoanModal.show(t,e)},syncEmployees(){g.post("delete-bio",this.selected).then(t=>{console.log(t)}).catch(t=>{console.log(t)})}}},z={key:0},K={class:"actions"};function q(t,e,s,G,i,c){const V=r("v-skeleton-loader"),I=r("v-text-field"),_=r("v-icon"),f=r("v-btn"),w=r("v-tooltip"),p=r("v-chip"),k=r("v-avatar"),D=r("v-data-table"),L=r("componentEdit"),R=r("v-snackbar"),E=r("v-card-title"),x=r("v-divider"),O=r("v-card-text"),B=r("v-spacer"),A=r("v-card-actions"),M=r("v-card"),S=r("v-dialog");return d(),v("div",null,[s.loading?(d(),m(V,{key:0,type:"table"})):(d(),m(D,{key:1,headers:s.headers,items:s.tableData.data,"sort-by":[{key:"punch_time",order:"desc"}],class:"elevation-2 sticky-table",search:i.search,loading:s.loading,"show-select":s.modelRoute==="employees",modelValue:i.selected,"onUpdate:modelValue":e[1]||(e[1]=o=>i.selected=o)},{top:n(()=>[l(I,{modelValue:i.search,"onUpdate:modelValue":e[0]||(e[0]=o=>i.search=o),"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",variant:"outlined",density:"compact"},null,8,["modelValue"]),i.selected.length>0?(d(),v("div",z,[l(w,{location:"top"},{activator:n(({props:o})=>[l(f,b({onClick:c.syncEmployees,icon:""},o),{default:n(()=>[l(_,{color:"error"},{default:n(()=>e[6]||(e[6]=[a(" mdi-cancel ")])),_:1})]),_:2},1040,["onClick"])]),default:n(()=>[e[7]||(e[7]=y("span",null,"Deactivate",-1))]),_:1})])):C("",!0)]),"item.actions":n(({item:o})=>[y("div",K,[(d(!0),v(N,null,W(s.actions,(h,j)=>(d(),m(w,{key:j,location:"bottom"},{activator:n(({props:P})=>[c.shouldShowButton(o,h)?(d(),m(f,b({key:0,icon:"",ref_for:!0},P,{onClick:H=>c.runAction(o,h),variant:"text",color:h.color}),{default:n(()=>[l(_,null,{default:n(()=>[a(u(h.icon),1)]),_:2},1024)]),_:2},1040,["onClick","color"])):C("",!0)]),default:n(()=>[y("span",null,u(h.action_name),1)]),_:2},1024))),128))])]),"item.checkin_status":n(({value:o})=>[l(p,{color:c.getColor(o),"prepend-icon":c.getIcon(o)},{default:n(()=>[a(u(o),1)]),_:2},1032,["color","prepend-icon"])]),"item.checkout_status":n(({value:o})=>[l(p,{color:c.getColor(o),"prepend-icon":c.getIcon(o)},{default:n(()=>[a(u(o),1)]),_:2},1032,["color","prepend-icon"])]),"item.photo":n(({value:o})=>[o?(d(),m(k,{key:1,image:"http://192.168.1.2:91"+o},null,8,["image"])):(d(),m(k,{key:0,icon:"mdi-account-circle"}))]),"item.status":n(({value:o})=>[l(p,{color:c.getColor(o),"prepend-icon":c.getIcon(o)},{default:n(()=>[a(u(o),1)]),_:2},1032,["color","prepend-icon"])]),"item.active":n(({value:o})=>[o?(d(),m(_,{key:0,color:"success",size:"x-small"},{default:n(()=>e[8]||(e[8]=[a("mdi-circle")])),_:1})):(d(),m(_,{key:1,color:"red",size:"x-small"},{default:n(()=>e[9]||(e[9]=[a("mdi-circle")])),_:1}))]),_:1},8,["headers","items","search","loading","show-select","modelValue"])),l(L,{ref:"editModal",modalWidth:s.modalWidth,modelRoute:s.modelRoute,title:s.title,onRefresh:c.refresh},null,8,["modalWidth","modelRoute","title","onRefresh"]),l(R,{modelValue:i.snackbar,"onUpdate:modelValue":e[2]||(e[2]=o=>i.snackbar=o),color:i.color},{default:n(()=>[a(u(i.text),1)]),_:1},8,["modelValue","color"]),l(S,{modelValue:i.dialogConfirm,"onUpdate:modelValue":e[5]||(e[5]=o=>i.dialogConfirm=o),"max-width":"400px"},{default:n(()=>[l(M,null,{default:n(()=>[l(E,{class:"text-h5"},{default:n(()=>e[10]||(e[10]=[a("Warning!")])),_:1}),l(x),l(O,null,{default:n(()=>[a(u(i.warning_text)+"? ",1)]),_:1}),l(x),l(A,null,{default:n(()=>[l(f,{color:"red-darken-1",variant:"tonal",onClick:e[3]||(e[3]=o=>i.dialogConfirm=!1)},{default:n(()=>[l(_,null,{default:n(()=>e[11]||(e[11]=[a("mdi-close-box")])),_:1}),e[12]||(e[12]=a("Cancel "))]),_:1}),l(B),l(f,{color:"primary",variant:"tonal",onClick:e[4]||(e[4]=o=>c.actionConfirm(i.current_data,i.current_route))},{default:n(()=>[l(_,null,{default:n(()=>e[13]||(e[13]=[a("mdi-checkbox-marked")])),_:1}),e[14]||(e[14]=a("OK "))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Z=F(T,[["render",q]]);export{Z as default};
