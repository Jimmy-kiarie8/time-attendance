import S from"./edit-BsOutCD8.js";import{V as p,i as r,o as c,d as k,c as u,w as n,b as s,y as x,f as a,a as g,e as j,t as _}from"./app-DCy3SzMC.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FormComponent-Club6oMY.js";const U={components:{componentEdit:S},props:{tableData:Object,formData:Object,headers:Object,modelRoute:String,title:String,loading:Boolean,upload:Boolean,canCreate:Boolean,actions:Object,modalWidth:Number},data(){return{search:"",page:1,sortBy:[{key:"reference",order:"desc"}],dialogDelete:!1,selected:[],itemsPerPage:5,editedIndex:-1,editedItem:{},dialogConfirm:!1,snackbar:!1,text:"Updated",color:"black",current_data:null,current_route:null,warning_text:"Are you sure you want to delete this item"}},methods:{reverse(t){this.dialogConfirm=!0,this.current_data=t,this.current_route=`reverse/${t.id}`,this.warning_text="Are you sure you want to reverse",action_run(t,route)},shouldShowButton(t,e){return e.show?Array.isArray(e.show.value)?e.show.value.includes(t[e.show.label]):e.show.value===t[e.show.label]:!0},getIcon(t){switch(t){case"On time":return"mdi-check-circle";case"Late":case"Early":return"mdi-cancel";default:return"mdi-information"}},getColor(t){switch(t){case"Late":case"Early":return"red";case"On time":return"success";case"In":return"Info";case"Out":return"secondary";default:return""}},valueInArray(t,e){e.some(function(l){return console.log(t,l),console.log(l===t),l===t})},async refresh(){this.$emit("refresh",!1)},runAction(t,e){e.action_name=="Edit"?this.openEdit(t):e.action_name=="Delete"?this.deleteItem(t):e.action_name=="View Loan"?this.openShow(t):e.action_name=="Documents"?this.upenDocument(t):e.action_name=="Logo"?this.uploadImage(t):e.action_name=="Password"?this.passwordReset(t,e.route):e.action_name=="Repay Loan"?this.openPayment(t,e.route):e.action_name=="Reschedule"?this.rescheduleLoan(t,e.route):e.action_name=="View Loan"?this.openLoan(t,e.route):e.action_name=="Approve"||e.action_name=="Reject"||e.action_name=="Disburse"?(this.dialogConfirm=!0,this.current_data=t,this.current_route=e.route,this.warning_text=`Are you sure you want to ${e.action_name}`):e.action_name=="Open File"?window.open(t.path,"_blank"):this.action_run(t,e.route)},async action_run(t,e){this.$props.loading=!0,this.dialogConfirm=!1;try{const l=await p.post(`/${e}`,t);console.log("ðŸš€ ~ dispatch ~ response:",l),this.refresh(),this.snackbar=!0,this.color="success",this.text=l.data.message??"Updated"}catch(l){console.log("ðŸš€ ~ axios.get ~ error:",l),this.snackbar=!0,this.color="error",this.text="Something went wrong!"}finally{this.$props.loading=!1}},goTo(t){router.visit(t)},openEdit(t){this.$refs.editModal.show(t)},openShow(t){this.$refs.showModal.show(t)},upenDocument(t){this.$refs.documentModal.show(t)},openPayment(t,e){this.$refs.paymentModal.show(t,e)},openLoan(t,e){this.$refs.showModal.show(t,e)},rescheduleLoan(t,e){this.$refs.rescheduleModal.show(t,e)},deleteItem(t){this.editedIndex=this.data.data.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){p.delete(`${this.modelRoute}/${this.editedItem.id}`).then(t=>{console.log("ðŸš€ ~ axios.delete ~ res:",t),this.dialogDelete=!0,this.data.data.splice(this.editedIndex,1),this.close()}).catch(t=>{console.log("ðŸš€ ~ axios.delete ~ error:",t)})},actionConfirm(t,e){this.action_run(t,e)},close(){this.dialogDelete=!1},uploadItem(){this.$refs.uploadModal.show()},editLoan(t,e){this.$refs.editLoanModal.show(t,e)},syncEmployees(){p.post("delete-bio",this.selected).then(t=>{console.log(t)}).catch(t=>{console.log(t)})}}},N={key:0},W={class:"actions"};function T(t,e,l,z,i,d){const b=r("v-skeleton-loader"),C=r("v-text-field"),m=r("v-icon"),h=r("v-btn"),v=r("v-tooltip"),f=r("v-chip"),y=r("v-avatar"),V=r("v-data-table"),I=r("componentEdit"),D=r("v-snackbar"),E=r("v-card-title"),w=r("v-divider"),L=r("v-card-text"),R=r("v-spacer"),O=r("v-card-actions"),B=r("v-card"),M=r("v-dialog");return c(),k("div",null,[l.loading?(c(),u(b,{key:0,type:"table"})):(c(),u(V,{key:1,headers:l.headers,items:l.tableData.data,"sort-by":[{key:"punch_time",order:"desc"}],class:"elevation-2 sticky-table",search:i.search,loading:l.loading,"show-select":l.modelRoute==="employees",modelValue:i.selected,"onUpdate:modelValue":e[1]||(e[1]=o=>i.selected=o)},{top:n(()=>[s(C,{modelValue:i.search,"onUpdate:modelValue":e[0]||(e[0]=o=>i.search=o),"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",variant:"outlined",density:"compact"},null,8,["modelValue"]),i.selected.length>0?(c(),k("div",N,[s(v,{location:"top"},{activator:n(({props:o})=>[s(h,x({onClick:d.syncEmployees,icon:""},o),{default:n(()=>[s(m,{color:"error"},{default:n(()=>e[6]||(e[6]=[a(" mdi-cancel ")])),_:1})]),_:2},1040,["onClick"])]),default:n(()=>[e[7]||(e[7]=g("span",null,"Deactivate",-1))]),_:1})])):j("",!0)]),"item.actions":n(({item:o})=>[g("div",W,[s(v,{location:"bottom"},{activator:n(({props:A})=>[s(h,x({icon:""},A,{variant:"text",color:"primary",onClick:F=>d.openEdit(o)}),{default:n(()=>[s(m,null,{default:n(()=>e[8]||(e[8]=[a("mdi-pen")])),_:1})]),_:2},1040,["onClick"])]),default:n(()=>[e[9]||(e[9]=g("span",null,"Edit",-1))]),_:2},1024)])]),"item.checkin_status":n(({value:o})=>[s(f,{color:d.getColor(o),"prepend-icon":d.getIcon(o)},{default:n(()=>[a(_(o),1)]),_:2},1032,["color","prepend-icon"])]),"item.checkout_status":n(({value:o})=>[s(f,{color:d.getColor(o),"prepend-icon":d.getIcon(o)},{default:n(()=>[a(_(o),1)]),_:2},1032,["color","prepend-icon"])]),"item.photo":n(({value:o})=>[o?(c(),u(y,{key:1,image:"http://192.168.1.2:91"+o},null,8,["image"])):(c(),u(y,{key:0,icon:"mdi-account-circle"}))]),"item.status":n(({value:o})=>[s(f,{color:d.getColor(o),"prepend-icon":d.getIcon(o)},{default:n(()=>[a(_(o),1)]),_:2},1032,["color","prepend-icon"])]),"item.active":n(({value:o})=>[o?(c(),u(m,{key:0,color:"success",size:"x-small"},{default:n(()=>e[10]||(e[10]=[a("mdi-circle")])),_:1})):(c(),u(m,{key:1,color:"red",size:"x-small"},{default:n(()=>e[11]||(e[11]=[a("mdi-circle")])),_:1}))]),_:1},8,["headers","items","search","loading","show-select","modelValue"])),s(I,{ref:"editModal",modalWidth:l.modalWidth,modelRoute:l.modelRoute,title:l.title,onRefresh:d.refresh},null,8,["modalWidth","modelRoute","title","onRefresh"]),s(D,{modelValue:i.snackbar,"onUpdate:modelValue":e[2]||(e[2]=o=>i.snackbar=o),color:i.color},{default:n(()=>[a(_(i.text),1)]),_:1},8,["modelValue","color"]),s(M,{modelValue:i.dialogConfirm,"onUpdate:modelValue":e[5]||(e[5]=o=>i.dialogConfirm=o),"max-width":"400px"},{default:n(()=>[s(B,null,{default:n(()=>[s(E,{class:"text-h5"},{default:n(()=>e[12]||(e[12]=[a("Warning!")])),_:1}),s(w),s(L,null,{default:n(()=>[a(_(i.warning_text)+"? ",1)]),_:1}),s(w),s(O,null,{default:n(()=>[s(h,{color:"red-darken-1",variant:"tonal",onClick:e[3]||(e[3]=o=>i.dialogConfirm=!1)},{default:n(()=>[s(m,null,{default:n(()=>e[13]||(e[13]=[a("mdi-close-box")])),_:1}),e[14]||(e[14]=a("Cancel "))]),_:1}),s(R),s(h,{color:"primary",variant:"tonal",onClick:e[4]||(e[4]=o=>d.actionConfirm(i.current_data,i.current_route))},{default:n(()=>[s(m,null,{default:n(()=>e[15]||(e[15]=[a("mdi-checkbox-marked")])),_:1}),e[16]||(e[16]=a("OK "))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const J=P(U,[["render",T]]);export{J as default};
