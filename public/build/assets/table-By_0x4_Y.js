import A from"./edit-DBFSnAB8.js";import{V as g,i as r,o as d,d as v,c as u,w as t,b as n,a as w,F as M,g as R,y as j,f as i,t as m,e as E}from"./app-C40yS1Zs.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FormComponent-BXJpgamY.js";const U={components:{componentEdit:A},props:{tableData:Object,headers:Object,modelRoute:String,title:String,loading:Boolean,canCreate:Boolean,actions:Object,modalWidth:Number},data(){return{search:"",page:1,sortBy:[{key:"reference",order:"desc"}],dialogDelete:!1,itemsPerPage:5,editedIndex:-1,editedItem:{},dialogConfirm:!1,snackbar:!1,text:"Updated",color:"black",current_data:null,current_route:null,warning_text:"Are you sure you want to delete this item"}},methods:{shouldShowButton(o,e){return e.show?Array.isArray(e.show.value)?e.show.value.includes(o[e.show.label]):e.show.value===o[e.show.label]:!0},getIcon(o){switch(o){case"Paid":return"mdi-check-circle";case"Rejected":return"mdi-cancel";case"Disbursed":return"mdi-arrow-bottom-right-bold-box";case"Over paid":return"mdi-debug-step-over";case"Pending":return"mdi-help-box";default:return"mdi-information"}},getColor(o){switch(o){case"Paid":return"success";case"Rejected":return"error";case"Disbursed":return"secondary";case"Over paid":return"primary";case"Pending":return"warning";default:return""}},valueInArray(o,e){e.some(function(s){return console.log(o,s),console.log(s===o),s===o})},async refresh(){this.$emit("refresh",!1)},runAction(o,e){e.action_name=="Edit"?this.openEdit(o):e.action_name=="Delete"?this.deleteItem(o):e.action_name=="View Loan"?this.openShow(o):e.action_name=="Documents"?this.upenDocument(o):e.action_name=="Logo"?this.uploadImage(o):e.action_name=="Password"?this.passwordReset(o,e.route):e.action_name=="Repay Loan"?this.openPayment(o,e.route):e.action_name=="Reschedule"?this.rescheduleLoan(o,e.route):e.action_name=="View Loan"?this.openLoan(o,e.route):e.action_name=="Approve"||e.action_name=="Reject"||e.action_name=="Disburse"?(this.dialogConfirm=!0,this.current_data=o,this.current_route=e.route,this.warning_text=`Are you sure you want to ${e.action_name}`):e.action_name=="Open File"?window.open(o.path,"_blank"):this.action_run(o,e.route)},async action_run(o,e){this.$props.loading=!0,this.dialogConfirm=!1;try{const s=await g.post(`/${e}`,o);console.log("ðŸš€ ~ dispatch ~ response:",s),this.refresh(),this.snackbar=!0,this.color="success",this.text=s.data.message??"Updated"}catch(s){console.log("ðŸš€ ~ axios.get ~ error:",s),this.snackbar=!0,this.color="error",this.text="Something went wrong!"}finally{this.$props.loading=!1}},goTo(o){router.visit(o)},openEdit(o){this.$refs.editModal.show(o)},openShow(o){this.$refs.showModal.show(o)},upenDocument(o){this.$refs.documentModal.show(o)},openPayment(o,e){this.$refs.paymentModal.show(o,e)},openLoan(o,e){this.$refs.showModal.show(o,e)},rescheduleLoan(o,e){this.$refs.rescheduleModal.show(o,e)},deleteItem(o){this.editedIndex=this.data.data.indexOf(o),this.editedItem=Object.assign({},o),this.dialogDelete=!0},deleteItemConfirm(){g.delete(`${this.modelRoute}/${this.editedItem.id}`).then(o=>{console.log("ðŸš€ ~ axios.delete ~ res:",o),this.dialogDelete=!0,this.data.data.splice(this.editedIndex,1),this.close()}).catch(o=>{console.log("ðŸš€ ~ axios.delete ~ error:",o)})},actionConfirm(o,e){this.action_run(o,e)},close(){this.dialogDelete=!1},uploadItem(){this.$refs.uploadModal.show()},editLoan(o,e){this.$refs.editLoanModal.show(o,e)}}},F={class:"actions"};function T(o,e,s,W,a,h){const x=r("v-skeleton-loader"),y=r("v-text-field"),_=r("v-icon"),f=r("v-btn"),b=r("v-tooltip"),k=r("v-data-table"),C=r("v-snackbar"),V=r("v-card-title"),p=r("v-divider"),D=r("v-card-text"),I=r("v-spacer"),L=r("v-card-actions"),P=r("v-card"),B=r("v-dialog");return d(),v("div",null,[s.loading?(d(),u(x,{key:0,type:"table"})):(d(),u(k,{key:1,headers:s.headers,items:s.tableData.data,"sort-by":[{key:"reference",order:"desc"}],class:"elevation-2 sticky-table",search:a.search,loading:s.loading},{top:t(()=>[n(y,{modelValue:a.search,"onUpdate:modelValue":e[0]||(e[0]=l=>a.search=l),"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},null,8,["modelValue"])]),"item.actions":t(({item:l})=>[w("div",F,[(d(!0),v(M,null,R(s.actions,(c,O)=>(d(),u(b,{key:O,location:"bottom"},{activator:t(({props:S})=>[h.shouldShowButton(l,c)?(d(),u(f,j({key:0,icon:"",ref_for:!0},S,{onClick:$=>h.runAction(l,c),variant:"text",color:c.color}),{default:t(()=>[n(_,null,{default:t(()=>[i(m(c.icon),1)]),_:2},1024)]),_:2},1040,["onClick","color"])):E("",!0)]),default:t(()=>[w("span",null,m(c.action_name),1)]),_:2},1024))),128))])]),_:1},8,["headers","items","search","loading"])),n(C,{modelValue:a.snackbar,"onUpdate:modelValue":e[1]||(e[1]=l=>a.snackbar=l),color:a.color},{default:t(()=>[i(m(a.text),1)]),_:1},8,["modelValue","color"]),n(B,{modelValue:a.dialogConfirm,"onUpdate:modelValue":e[4]||(e[4]=l=>a.dialogConfirm=l),"max-width":"400px"},{default:t(()=>[n(P,null,{default:t(()=>[n(V,{class:"text-h5"},{default:t(()=>e[5]||(e[5]=[i("Warning!")])),_:1}),n(p),n(D,null,{default:t(()=>[i(m(a.warning_text)+"? ",1)]),_:1}),n(p),n(L,null,{default:t(()=>[n(f,{color:"red-darken-1",variant:"tonal",onClick:e[2]||(e[2]=l=>a.dialogConfirm=!1)},{default:t(()=>[n(_,null,{default:t(()=>e[6]||(e[6]=[i("mdi-close-box")])),_:1}),e[7]||(e[7]=i("Cancel "))]),_:1}),n(I),n(f,{color:"primary",variant:"tonal",onClick:e[3]||(e[3]=l=>h.actionConfirm(a.current_data,a.current_route))},{default:t(()=>[n(_,null,{default:t(()=>e[8]||(e[8]=[i("mdi-checkbox-marked")])),_:1}),e[9]||(e[9]=i("OK "))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const H=N(U,[["render",T]]);export{H as default};
